{{ define "main" }}
  {{ if .Content }}
    <div class="index-content {{ if .Params.framed -}}framed{{- end -}}">
      {{ .Content }}
    </div>
  {{ end }}

  <!-- Recent Posts Section -->
  <div class="recent-posts">
    <h2>Recent Posts</h2>
    {{ $isntDefault := not (or (eq (trim $.Site.Params.contentTypeName " ") "posts") (eq (trim $.Site.Params.contentTypeName " ") "")) }}
    {{ $contentTypeName := cond $isntDefault (string $.Site.Params.contentTypeName) "posts" }}
    
    {{ $recentPosts := first 5 (where .Site.RegularPages "Type" $contentTypeName) }}
    {{ if $recentPosts }}
      {{ range $recentPosts }}
        <article class="post on-list">
          <h3 class="post-title">
            <a href="{{ .Permalink }}">{{ .Title | markdownify }}</a>
          </h3>

          <div class="post-meta">
            {{- if .Date -}}
              <time class="post-date">
                {{- partial "post-date" . -}}
              </time>
            {{- end -}}
            {{- if .Site.Params.readingTime -}}
              {{- if .ReadingTime -}}
                <span class="reading-time"> • {{ .ReadingTime }} {{ $.Site.Params.minuteReadingTime | default "min read" }}</span>
              {{- end -}}
            {{- end -}}
          </div>

          {{ if .Params.tags }}
            <span class="post-tags">
              {{ range .Params.tags }}
              #<a href="{{ (urlize (printf "tags/%s/" . )) | absLangURL }}">
                {{- . -}}
              </a>&nbsp;
              {{ end }}
            </span>
          {{ end }}

          <div class="post-content">
            {{ if .Description }}
              <p>{{ .Description | markdownify }}</p>
            {{ else }}
              <p>{{ .Summary | truncate 150 }}</p>
            {{ end }}
          </div>

          <div>
            <a class="read-more button inline" href="{{ .RelPermalink }}">{{ $.Site.Params.readMore | default "Read more" }}</a>
          </div>
        </article>
      {{ end }}
      
      <div class="all-posts-link">
        <a class="button" href="/posts/">View All Posts →</a>
      </div>
    {{ else }}
      <p>No posts yet. Check back soon!</p>
    {{ end }}
  </div>
{{ end }}